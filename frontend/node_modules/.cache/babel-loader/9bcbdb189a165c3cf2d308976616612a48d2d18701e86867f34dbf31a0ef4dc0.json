{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { authService } from '../../services/authService';\nexport const login = createAsyncThunk('auth/login', async ({\n  email,\n  password\n}, {\n  rejectWithValue\n}) => {\n  try {\n    console.log('üîë Redux: Attempting login for:', email);\n    const response = await authService.login(email, password);\n    console.log('‚úÖ Redux: Login successful, response:', response.data);\n    return response.data;\n  } catch (error) {\n    var _error$response, _error$response$data;\n    console.error('‚ùå Redux: Login failed', error);\n    const errorMessage = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message || 'Login failed';\n    return rejectWithValue(errorMessage);\n  }\n});\nexport const register = createAsyncThunk('auth/register', async (userData, {\n  rejectWithValue\n}) => {\n  try {\n    console.log('üìù Redux: Attempting registration for:', userData.email);\n    const response = await authService.register(userData);\n    console.log('‚úÖ Redux: Registration successful, response:', response.data);\n    return response.data;\n  } catch (error) {\n    var _error$response2, _error$response2$data, _error$response3, _error$response3$data;\n    console.error('‚ùå Redux: Registration failed', error);\n    const errorMessage = ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.error) || error.message || 'Registration failed';\n    return rejectWithValue(errorMessage);\n  }\n});\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: null,\n    token: localStorage.getItem('token'),\n    isLoading: false,\n    error: null,\n    isAuthenticated: false // Start as false, only set to true after successful API call\n  },\n  reducers: {\n    logout: state => {\n      console.log('üö™ Logging out user');\n      state.user = null;\n      state.token = null;\n      state.isAuthenticated = false;\n      localStorage.removeItem('token');\n    },\n    clearError: state => {\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder\n    // Login\n    .addCase(login.pending, state => {\n      console.log('üîÑ Login pending...');\n      state.isLoading = true;\n      state.error = null;\n    }).addCase(login.fulfilled, (state, action) => {\n      console.log('‚úÖ Login fulfilled with data:', action.payload);\n      state.isLoading = false;\n      state.user = action.payload.user;\n      state.token = action.payload.access_token;\n      state.isAuthenticated = true;\n      localStorage.setItem('token', action.payload.access_token);\n    }).addCase(login.rejected, (state, action) => {\n      console.log('‚ùå Login rejected with error:', action.payload);\n      state.isLoading = false;\n      state.error = action.payload;\n      state.isAuthenticated = false;\n    })\n    // Register\n    .addCase(register.pending, state => {\n      console.log('üîÑ Registration pending...');\n      state.isLoading = true;\n      state.error = null;\n      state.isAuthenticated = false; // Ensure it's false during registration\n    }).addCase(register.fulfilled, (state, action) => {\n      console.log('‚úÖ Registration fulfilled with data:', action.payload);\n      state.isLoading = false;\n      state.user = action.payload.user;\n      state.token = action.payload.access_token;\n      state.isAuthenticated = true; // Only set to true after successful API response\n      localStorage.setItem('token', action.payload.access_token);\n    }).addCase(register.rejected, (state, action) => {\n      console.log('‚ùå Registration rejected with error:', action.payload);\n      state.isLoading = false;\n      state.error = action.payload;\n      state.isAuthenticated = false;\n    });\n  }\n});\nexport const {\n  logout,\n  clearError\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","authService","login","email","password","rejectWithValue","console","log","response","data","error","_error$response","_error$response$data","errorMessage","message","register","userData","_error$response2","_error$response2$data","_error$response3","_error$response3$data","authSlice","name","initialState","user","token","localStorage","getItem","isLoading","isAuthenticated","reducers","logout","state","removeItem","clearError","extraReducers","builder","addCase","pending","fulfilled","action","payload","access_token","setItem","rejected","actions","reducer"],"sources":["/home/ali-hussein/far-mart/frontend/src/store/slices/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { authService } from '../../services/authService';\n\nexport const login = createAsyncThunk(\n  'auth/login',\n  async ({ email, password }, { rejectWithValue }) => {\n    try {\n      console.log('üîë Redux: Attempting login for:', email);\n      const response = await authService.login(email, password);\n      console.log('‚úÖ Redux: Login successful, response:', response.data);\n      return response.data;\n    } catch (error) {\n      console.error('‚ùå Redux: Login failed', error);\n      const errorMessage = error.response?.data?.message || error.message || 'Login failed';\n      return rejectWithValue(errorMessage);\n    }\n  }\n);\n\nexport const register = createAsyncThunk(\n  'auth/register',\n  async (userData, { rejectWithValue }) => {\n    try {\n      console.log('üìù Redux: Attempting registration for:', userData.email);\n      const response = await authService.register(userData);\n      console.log('‚úÖ Redux: Registration successful, response:', response.data);\n      return response.data;\n    } catch (error) {\n      console.error('‚ùå Redux: Registration failed', error);\n      const errorMessage = error.response?.data?.message || error.response?.data?.error || error.message || 'Registration failed';\n      return rejectWithValue(errorMessage);\n    }\n  }\n);\n\nconst authSlice = createSlice({\n  name: 'auth',\n  initialState: {\n    user: null,\n    token: localStorage.getItem('token'),\n    isLoading: false,\n    error: null,\n    isAuthenticated: false, // Start as false, only set to true after successful API call\n  },\n  reducers: {\n    logout: (state) => {\n      console.log('üö™ Logging out user');\n      state.user = null;\n      state.token = null;\n      state.isAuthenticated = false;\n      localStorage.removeItem('token');\n    },\n    clearError: (state) => {\n      state.error = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      // Login\n      .addCase(login.pending, (state) => {\n        console.log('üîÑ Login pending...');\n        state.isLoading = true;\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        console.log('‚úÖ Login fulfilled with data:', action.payload);\n        state.isLoading = false;\n        state.user = action.payload.user;\n        state.token = action.payload.access_token;\n        state.isAuthenticated = true;\n        localStorage.setItem('token', action.payload.access_token);\n      })\n      .addCase(login.rejected, (state, action) => {\n        console.log('‚ùå Login rejected with error:', action.payload);\n        state.isLoading = false;\n        state.error = action.payload;\n        state.isAuthenticated = false;\n      })\n      // Register\n      .addCase(register.pending, (state) => {\n        console.log('üîÑ Registration pending...');\n        state.isLoading = true;\n        state.error = null;\n        state.isAuthenticated = false; // Ensure it's false during registration\n      })\n      .addCase(register.fulfilled, (state, action) => {\n        console.log('‚úÖ Registration fulfilled with data:', action.payload);\n        state.isLoading = false;\n        state.user = action.payload.user;\n        state.token = action.payload.access_token;\n        state.isAuthenticated = true; // Only set to true after successful API response\n        localStorage.setItem('token', action.payload.access_token);\n      })\n      .addCase(register.rejected, (state, action) => {\n        console.log('‚ùå Registration rejected with error:', action.payload);\n        state.isLoading = false;\n        state.error = action.payload;\n        state.isAuthenticated = false;\n      });\n  },\n});\n\nexport const { logout, clearError } = authSlice.actions;\nexport default authSlice.reducer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}